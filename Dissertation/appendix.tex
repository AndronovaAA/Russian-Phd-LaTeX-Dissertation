\chapter{Параметры программы}\label{app:A}
\begin{comment}
	
Выражение \eqref{eq:Young_conjugated} может быть записано как:
%
\begin{multline}
	\begin{bmatrix}
		{\Pi}_1 & 0 \\ 0 & {\Sigma}_2 
	\end{bmatrix}+
	\begin{bmatrix}
		0&-{BK}\\-({BK})\T&0
	\end{bmatrix}+
	\begin{bmatrix}
		{M}_1{F}_1{N}_1{Q}_1 + {Q}_1({M}_1{F}_1{N}_1)\T&0 \\ 0& 0
	\end{bmatrix}
	\\ + \begin{bmatrix}
		0& {Q}_1({S} {M}_1{F}_1{N}_1)\T{P}_2 \\
		{P}_2{M}_1{F}_1{N}_1{Q}_1 - ({BK})\T & 0
	\end{bmatrix}<0,
\end{multline}
%
раскрываем:
%
\begin{multline}
	\label{eq:Young_expand}
	\begin{bmatrix}
		{\Pi}_1 & 0 \\ 0 & {\Sigma}_2 
	\end{bmatrix}+ \begin{bmatrix}
		-{BK} \\ 0
	\end{bmatrix}\begin{bmatrix}
		0 \\ {I}
	\end{bmatrix}\T
	+\begin{bmatrix}
		0 \\ {I} 
	\end{bmatrix}\begin{bmatrix}
		-{BK} \\0
	\end{bmatrix}\T+\begin{bmatrix}
		{Q}_1{N}_1\T \\0
	\end{bmatrix}{F}_1\T\begin{bmatrix}
		{M}_1 \\0
	\end{bmatrix}\T \\ + \begin{bmatrix}
		{M}_1 \\0
	\end{bmatrix}{F}_1\begin{bmatrix}
		{Q}_1{N}_1\T \\0
	\end{bmatrix}\T+\begin{bmatrix}
		{Q}_1{N}_1\T \\ 0
	\end{bmatrix}{F}_1\T\begin{bmatrix}
		0 \\ {P}_2{S}{M}_1
	\end{bmatrix}\T+  \begin{bmatrix}
		0\\ {P}_2{S}{M}_1
	\end{bmatrix}{F}_1\begin{bmatrix}
		{Q}_1{N}_1\T \\0
	\end{bmatrix}\T<0.
\end{multline}
%
Используя \eqref{eq:Young_relation_BMI} из леммы \ref{lemma:Young} \cite{KHELOUFI2013}, находим:
%
\begin{multline}
	\label{eq:thm1_term_1}
	\begin{bmatrix}
		-{BK} \\ 0
	\end{bmatrix}\begin{bmatrix}
		0 \\ {I}
	\end{bmatrix}\T
	+\begin{bmatrix}
		0 \\ {I} 
	\end{bmatrix}\begin{bmatrix}
		-{BK} \\0
	\end{bmatrix}\T 
	\\ 
	\leq
	\begin{bmatrix}
		-{BK} \\ 0
	\end{bmatrix} \epsilon_1 {H} \begin{bmatrix}
		-{BK} \\ 0
	\end{bmatrix}\T +\begin{bmatrix}
		0 \\ {I}
	\end{bmatrix}\frac{1}{\epsilon_1}{H}^{-1}\begin{bmatrix}
		0 \\ {I}
	\end{bmatrix}\T =
	\begin{bmatrix}
		{BK}\epsilon_1{H}{K}\T{B}\T & 0 \\
		0 & \frac{1}{\epsilon_1}{H}^{-1}
	\end{bmatrix}.
\end{multline}
%
Из неравенства \eqref{eq:Young_robust_2} и леммы \ref{lemma:Young} с $\nu=1$ получаем:
%
\begin{multline}
	\label{eq:thm1_term_2}
	\begin{bmatrix}
		{Q}_1{N}_1\T \\0
	\end{bmatrix}{F}_1\T\begin{bmatrix}
		{M}_1 \\0
	\end{bmatrix}\T+\begin{bmatrix}
		{M}_1 \\0
	\end{bmatrix}{F}_1\begin{bmatrix}
		{Q}_1{N}_1\T \\0
	\end{bmatrix}\T  \\ \leq \frac{1}{\epsilon_2}\begin{bmatrix}
		{Q}_1{N}_1\T \\0
	\end{bmatrix}\begin{bmatrix}
		{Q}_1{N}_1\T \\ 0
	\end{bmatrix}\T +\epsilon_2 \begin{bmatrix}
		{M}_1 \\0
	\end{bmatrix}\begin{bmatrix}
		{M}_1 \\0
	\end{bmatrix}\T.
\end{multline}
%
Похожим образом:
%
\begin{multline}
	\label{eq:thm1_term_3}
	\begin{bmatrix}
		{Q}_1{N}_1\T \\0
	\end{bmatrix}{F}_1\T\begin{bmatrix}
		0 \\ {P}_2{S}{M}_1
	\end{bmatrix}\T+\begin{bmatrix}
		0\\ {P}_2{S}{M}_1
	\end{bmatrix}{F}_1\begin{bmatrix}
		{Q}_1{N}_1\T \\0
	\end{bmatrix}\T \\ \leq  \frac{1}{\epsilon_3}\begin{bmatrix}
		{Q}_1{N}_1\T \\0
	\end{bmatrix}\begin{bmatrix}
		{Q}_1{N}_1\T \\ 0
	\end{bmatrix}\T +\epsilon_3 \begin{bmatrix}
		0 \\ {P}_2{S}{M}_1
	\end{bmatrix}\begin{bmatrix}
		0 \\ {P}_2{S}{M}_1
	\end{bmatrix}\T.
\end{multline}
%
Подставляя \eqref{eq:thm1_term_1},\eqref{eq:thm1_term_2} и \eqref{eq:thm1_term_3} в \eqref{eq:Young_expand} получаем выражение \eqref{eq:thm1_LMI_after_Young}.

\clearpage
\refstepcounter{chapter}

\end{comment}
Взгляд на динамику и управление, описанный в данной работе, в значительной степени опирается на инструменты оптимизации --- и их успех на практике в значительной степени зависит от эффективного применения численной оптимизации.
Все численные эксперименты были написаны на \textit{Python}.
\textit{Python} --- мультипарадигмальный высокоуровневый язык программирования общего назначения с динамической строгой типизацией и автоматическим управлением памятью, ориентированный на повышение производительности разработчика, читаемости кода и его качества, а также на обеспечение переносимости написанных на нём программ \cite{python}.

Для формулирования задач оптимизационного управления была использована библиотека \textit{CVXPY}.
\textit{CVXPY} --- это встроенный в Python язык моделирования выпуклых оптимизационных задач с открытым исходным кодом \cite{cvxpy}. Он позволяет выразить задачу естественным образом, следуя математике, а не в ограничительной стандартной форме, требуемой решателями.

В качестве решателя был использован \textit{MOSEK}.
Оптимизационное программное обеспечение \textit{MOSEK} \cite{mosek} решает масштабные задачи математической оптимизации. С 1999 года \textit{MOSEK} является одним из наиболее предпочтительных программных продуктов для математической оптимизации в различных отраслях промышленности. 

Для решения ОДУ был использован метод \textit{lisoda} --- это обёртка для \textit{Fortran} решателя из \textit{ODEPACK} \cite{Hindmarsh}. Он автоматически переключается между нежёстким методом Адамса и жёстким методом обратных дифференциальных операторов. Первоначально метод был подробно описан в \cite{Petzold}.

Функции линейной алгебры \textit{NumPy} опираются на \textit{BLAS} и \textit{LAPACK}, обеспечивая эффективную низкоуровневую реализацию стандартных алгоритмов линейной алгебры. 

Параметры, использованные в экспериментах представлены в таблице \ref{tab:solverParam}.

\DefTblrTemplate{contfoot-text}{default}{\small\slshape продолжение следует} % переделали default шаблон, используемый по-умолчанию
\DefTblrTemplate{conthead-text}{default}{\small\slshape (продолжение)} % переделали normal default, используемый по-умолчанию
\DefTblrTemplate{capcont}{default}{\centering\UseTblrTemplate{conthead-text}{default}\par} % для работы центрирования обязательно \par
\DefTblrTemplate{caplast}{default}{\small\slshape (окончание)}
\DefTblrTemplate{lasthead}{default}{\centering\UseTblrTemplate{caplast}{default}\par} % для работы центрирования обязательно \par
\DefTblrTemplate{firsthead}{default}{% правим шаблон у первого заголовка, чтобы считывал настройки из пакета caption
	% https://tex.stackexchange.com/a/628973
	\addtocounter{table}{-1}%
	\IfTokenListEmpty{\InsertTblrText{entry}}{% важно, чтобы не дублировались записи в списке таблиц
		\captionof{table}{\InsertTblrText{caption}}%
	}{%
		\captionof{table}[\InsertTblrText{entry}]{\InsertTblrText{caption}}%
	}% если будет запись в entry, то она пойдет в список таблиц, см. документацию tabularray
}
\SetTblrTemplate{caption-lot}{empty} % важно, чтобы не дублировались записи в списке таблиц
\begin{longtblr}[
	caption = {Параметры вычислений},
	label = {tab:solverParam},
	]{
		colspec = {%
			@{}>{\setlength{\baselineskip}{0.7\baselineskip}}X[1.1,m,c]%
			>{\setlength{\baselineskip}{0.7\baselineskip}}X[1.1,m,c]%
			X[4,l]@{}%
		},
		width = \textwidth,
		rowhead = 1,
		rows={rowsep=3pt},
		row{1}={rowsep=2pt},
	}
	\toprule     %%% верхняя линейка
			{Параметр} & {Значение параметра} \\
			\midrule 
			Максимальное нарушение абсолютной двойственной границы в оптимальном базисном решении  & $ 1.0 \cdot 10^{-6} $  \\
			Абсолютная нулевая толерантность в элементах в симметричных матрицах           & $ 1.0 \cdot 10^{-12} $   \\
			Любая граница, которая по абсолютной величине больше этого параметра, считается бесконечной        & $ 1.0 \cdot 10^{16} $ \\
			Нулевая толерантность для ограничений и переменных, т.е. если расстояние между нижней и верхней границей меньше данного значения, то нижняя и верхняя границы считаются идентичными        & $ 1.0 \cdot 10^{-8} $ \\
			Допуск на неосуществимость, используемый оптимизатором внутренней точки для конических задач        & $ 1.0 \cdot 10^{-12} $  \\
			Управляет начальной первичной точкой, используемой оптимизатором с внутренней точкой & $ 1.0 $ \\
			Минимальный допустимый размер шага & $ 1.0 \cdot 10^{-6} $ \\
			Абсолютный целочисленный допуск на выполнимость & $ 1.0 \cdot 10^{-5} $ \\
			Допуск для определения положительной полуопределённой матрицы & $ 1.0 \cdot 10^{-10} $ \\
			Максимальное количество времени, которое оптимизатор может потратить на оптимизацию (в секундах). Отрицательное число означает бесконечность & $ -1.0 $ \\
			Максимальное количеством итераций, допустимых в оптимизаторе внутренней точки & $ 400 $ \\
			Допуск на ошибку, для решателя \textit{lisoda} & $ 1.49012 \cdot 10^{-8} $ \\
			Отсечение для малых сингулярных значений при подсчёте псевдообратной матрицы & $ 1.0 \cdot 10^{-15} $ \\
    \bottomrule %%% нижняя линейка
\end{longtblr}

\chapter{Дополнительные шаги для вычислений}\label{app:B}

Перед вычислениями параметров регуляторов и наблюдателей проводились также тесты на наблюдаемость и управление системы. 

Для проверки может ли система быть управляемой, используется лемма Хаутуса, также широко известная как тест Попова--Белевича--Хаутуса \cite{bernstein2018scalar}.
\begin{lemma}
	Пара матриц $(A, B)$ является управляемой тогда и только тогда, когда не существует левого собственного вектора матрицы $A$, ортогонального к столбцам матрицы $B$.
\end{lemma}

Для проверки системы на наблюдаемость используется также тест Попова--Белевича--Хаутуса \cite{Sontag1998}.

\begin{lemma}
	Пара матриц $(C, A)$ наблюдаема тогда и только тогда, когда не существует правого собственного вектора матрицы $A$, ортогонального столбцам матрицы $C$.
\end{lemma}

\chapter{Способы задания неопределённостей}\label{app:С}
	
Неизвестные величины задаются с помощью ограниченных по норме матриц неопределённости, удовлетворяющая условию ${F}_i\T{F}_i\leq {I}$. Для гарантии соответствия ограничениям используем функцию \textit{numpy.random.randn}, которая возвращает массив значений с плавающей точкой из стандартного нормального распределения. Далее применяется QR-разложение --- представление матрицы в виде произведения унитарной (или ортогональной матрицы) и верхнетреугольной матрицы \cite{horn1990matrix}. Для неопределённости берём матрицу \textit{Q} после разложения, так как у неё ортонормированы столбцы.

\begin{ListingEnv}[!h]	
\captiondelim{ } % разделитель идентификатора с номером от наименования
\caption{Программа задания неопределённости}\label{lst:delta}
	\begin{Verb}
		import numpy as np
		
		# dim_Delta - размерность матрицы F
		Random_matrix = np.random.randn(dim_Delta, dim_Delta)
		# QR-декомпозиция, Q матрица с ортонормированными столбцами
		F, _ = np.linalg.qr(Random_matrix)
	\end{Verb}
\end{ListingEnv}